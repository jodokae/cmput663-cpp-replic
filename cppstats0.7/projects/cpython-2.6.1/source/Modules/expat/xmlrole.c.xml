<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<unit xmlns="http://www.sdml.info/srcML/src" xmlns:cpp="http://www.sdml.info/srcML/cpp" language="C" filename="projects/cpython-2.6.1/source/Modules/expat/xmlrole.c"><comment type="block">/* Copyright (c) 1998, 1999 Thai Open Source Software Center Ltd
   See the file COPYING for copying permission.
*/</comment>

<cpp:ifdef>#<cpp:directive>ifdef</cpp:directive> <name>COMPILED_FROM_DSP</name></cpp:ifdef>
<cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>"winconfig.h"</cpp:file></cpp:include>
<cpp:elif>#<cpp:directive>elif</cpp:directive> <expr><call><name>defined</name><argument_list>(<argument><expr><name>MACOS_CLASSIC</name></expr></argument>)</argument_list></call></expr></cpp:elif>
<cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>"macconfig.h"</cpp:file></cpp:include>
<cpp:elif>#<cpp:directive>elif</cpp:directive> <expr><call><name>defined</name><argument_list>(<argument><expr><name>__amigaos4__</name></expr></argument>)</argument_list></call></expr></cpp:elif>
<cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>"amigaconfig.h"</cpp:file></cpp:include>
<cpp:else>#<cpp:directive>else</cpp:directive></cpp:else>
<cpp:ifdef>#<cpp:directive>ifdef</cpp:directive> <name>HAVE_EXPAT_CONFIG_H</name></cpp:ifdef>
<cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>&lt;expat_config.h&gt;</cpp:file></cpp:include>
<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif>
<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif> <comment type="block">/* ndef COMPILED_FROM_DSP */</comment>

<cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>&lt;stddef.h&gt;</cpp:file></cpp:include>

<cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>"expat_external.h"</cpp:file></cpp:include>
<cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>"internal.h"</cpp:file></cpp:include>
<cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>"xmlrole.h"</cpp:file></cpp:include>
<cpp:include>#<cpp:directive>include</cpp:directive> <cpp:file>"ascii.h"</cpp:file></cpp:include>

<comment type="block">/* Doesn't check:

 that ,| are not mixed in a model group
 content of literals

*/</comment>

<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_ANY</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_A</name></expr>, <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_Y</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_ATTLIST</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_A</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_L</name></expr>, <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_S</name></expr>, <expr><name>ASCII_T</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_CDATA</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_C</name></expr>, <expr><name>ASCII_D</name></expr>, <expr><name>ASCII_A</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_A</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_DOCTYPE</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_D</name></expr>, <expr><name>ASCII_O</name></expr>, <expr><name>ASCII_C</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_Y</name></expr>, <expr><name>ASCII_P</name></expr>, <expr><name>ASCII_E</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_ELEMENT</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_L</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_M</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_T</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_EMPTY</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_M</name></expr>, <expr><name>ASCII_P</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_Y</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_ENTITIES</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_S</name></expr>,
    <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_ENTITY</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_Y</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_FIXED</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_F</name></expr>, <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_X</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_D</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_ID</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_D</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_IDREF</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_D</name></expr>, <expr><name>ASCII_R</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_F</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_IDREFS</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_D</name></expr>, <expr><name>ASCII_R</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_F</name></expr>, <expr><name>ASCII_S</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_IGNORE</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_G</name></expr>, <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_O</name></expr>, <expr><name>ASCII_R</name></expr>, <expr><name>ASCII_E</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_IMPLIED</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_M</name></expr>, <expr><name>ASCII_P</name></expr>, <expr><name>ASCII_L</name></expr>, <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_D</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_INCLUDE</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_C</name></expr>, <expr><name>ASCII_L</name></expr>, <expr><name>ASCII_U</name></expr>, <expr><name>ASCII_D</name></expr>, <expr><name>ASCII_E</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_NDATA</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_D</name></expr>, <expr><name>ASCII_A</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_A</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_NMTOKEN</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_M</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_O</name></expr>, <expr><name>ASCII_K</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_N</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_NMTOKENS</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_M</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_O</name></expr>, <expr><name>ASCII_K</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_S</name></expr>,
    <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_NOTATION</name><index>[]</index></name> <init>=
    <expr><block>{ <expr><name>ASCII_N</name></expr>, <expr><name>ASCII_O</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_A</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_O</name></expr>, <expr><name>ASCII_N</name></expr>,
      <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_PCDATA</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_P</name></expr>, <expr><name>ASCII_C</name></expr>, <expr><name>ASCII_D</name></expr>, <expr><name>ASCII_A</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_A</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_PUBLIC</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_P</name></expr>, <expr><name>ASCII_U</name></expr>, <expr><name>ASCII_B</name></expr>, <expr><name>ASCII_L</name></expr>, <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_C</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_REQUIRED</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_R</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_Q</name></expr>, <expr><name>ASCII_U</name></expr>, <expr><name>ASCII_I</name></expr>, <expr><name>ASCII_R</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_D</name></expr>,
    <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>
<decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name></type> <name><name>KW_SYSTEM</name><index>[]</index></name> <init>= <expr><block>{
    <expr><name>ASCII_S</name></expr>, <expr><name>ASCII_Y</name></expr>, <expr><name>ASCII_S</name></expr>, <expr><name>ASCII_T</name></expr>, <expr><name>ASCII_E</name></expr>, <expr><name>ASCII_M</name></expr>, <expr>'\0'</expr> }</block></expr></init></decl>;</decl_stmt>

<cpp:ifndef>#<cpp:directive>ifndef</cpp:directive> <name>MIN_BYTES_PER_CHAR</name></cpp:ifndef>
<cpp:define>#<cpp:directive>define</cpp:directive> <cpp:macro><name>MIN_BYTES_PER_CHAR</name><parameter_list>(<param><type><name>enc</name></type></param>)</parameter_list></cpp:macro> <cpp:value>((enc)-&gt;minBytesPerChar)</cpp:value></cpp:define>
<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif>

<cpp:ifdef>#<cpp:directive>ifdef</cpp:directive> <name>XML_DTD</name></cpp:ifdef>
<cpp:define>#<cpp:directive>define</cpp:directive> <cpp:macro><name>setTopLevel</name><parameter_list>(<param><type><name>state</name></type></param>)</parameter_list></cpp:macro> \
  <cpp:value>((state)-&gt;handler = ((state)-&gt;documentEntity \
                       ? internalSubset \
                       : externalSubset1))</cpp:value></cpp:define>
<cpp:else>#<cpp:directive>else</cpp:directive></cpp:else> <comment type="block">/* not XML_DTD */</comment>
<cpp:define>#<cpp:directive>define</cpp:directive> <cpp:macro><name>setTopLevel</name><parameter_list>(<param><type><name>state</name></type></param>)</parameter_list></cpp:macro> <cpp:value>((state)-&gt;handler = internalSubset)</cpp:value></cpp:define>
<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif> <comment type="block">/* not XML_DTD */</comment>

<typedef>typedef <function_decl><type><name>int</name> <name>PTRCALL</name></type> <name>PROLOG_HANDLER</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
                                   <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
                                   <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
                                   <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
                                   <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>;</function_decl></typedef>

<decl_stmt><decl><type><specifier>static</specifier> <name>PROLOG_HANDLER</name></type>
  <name>prolog0</name></decl>, <decl><type ref="prev"/><name>prolog1</name></decl>, <decl><type ref="prev"/><name>prolog2</name></decl>,
  <decl><type ref="prev"/><name>doctype0</name></decl>, <decl><type ref="prev"/><name>doctype1</name></decl>, <decl><type ref="prev"/><name>doctype2</name></decl>, <decl><type ref="prev"/><name>doctype3</name></decl>, <decl><type ref="prev"/><name>doctype4</name></decl>, <decl><type ref="prev"/><name>doctype5</name></decl>,
  <decl><type ref="prev"/><name>internalSubset</name></decl>,
  <decl><type ref="prev"/><name>entity0</name></decl>, <decl><type ref="prev"/><name>entity1</name></decl>, <decl><type ref="prev"/><name>entity2</name></decl>, <decl><type ref="prev"/><name>entity3</name></decl>, <decl><type ref="prev"/><name>entity4</name></decl>, <decl><type ref="prev"/><name>entity5</name></decl>, <decl><type ref="prev"/><name>entity6</name></decl>,
  <decl><type ref="prev"/><name>entity7</name></decl>, <decl><type ref="prev"/><name>entity8</name></decl>, <decl><type ref="prev"/><name>entity9</name></decl>, <decl><type ref="prev"/><name>entity10</name></decl>,
  <decl><type ref="prev"/><name>notation0</name></decl>, <decl><type ref="prev"/><name>notation1</name></decl>, <decl><type ref="prev"/><name>notation2</name></decl>, <decl><type ref="prev"/><name>notation3</name></decl>, <decl><type ref="prev"/><name>notation4</name></decl>,
  <decl><type ref="prev"/><name>attlist0</name></decl>, <decl><type ref="prev"/><name>attlist1</name></decl>, <decl><type ref="prev"/><name>attlist2</name></decl>, <decl><type ref="prev"/><name>attlist3</name></decl>, <decl><type ref="prev"/><name>attlist4</name></decl>, <decl><type ref="prev"/><name>attlist5</name></decl>, <decl><type ref="prev"/><name>attlist6</name></decl>,
  <decl><type ref="prev"/><name>attlist7</name></decl>, <decl><type ref="prev"/><name>attlist8</name></decl>, <decl><type ref="prev"/><name>attlist9</name></decl>,
  <decl><type ref="prev"/><name>element0</name></decl>, <decl><type ref="prev"/><name>element1</name></decl>, <decl><type ref="prev"/><name>element2</name></decl>, <decl><type ref="prev"/><name>element3</name></decl>, <decl><type ref="prev"/><name>element4</name></decl>, <decl><type ref="prev"/><name>element5</name></decl>, <decl><type ref="prev"/><name>element6</name></decl>,
  <decl><type ref="prev"/><name>element7</name></decl>,
<cpp:ifdef>#<cpp:directive>ifdef</cpp:directive> <name>XML_DTD</name></cpp:ifdef>
  <decl><type ref="prev"/><name>externalSubset0</name></decl>, <decl><type ref="prev"/><name>externalSubset1</name></decl>,
  <decl><type ref="prev"/><name>condSect0</name></decl>, <decl><type ref="prev"/><name>condSect1</name></decl>, <decl><type ref="prev"/><name>condSect2</name></decl>,
<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif> <comment type="block">/* XML_DTD */</comment>
  <decl><type ref="prev"/><name>declClose</name></decl>,
  <decl><type ref="prev"/><name>error</name></decl>;</decl_stmt>

<function_decl><type><specifier>static</specifier> <name>int</name> <name>FASTCALL</name></type> <name>common</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>, <param><decl><type><name>int</name></type> <name>tok</name></decl></param>)</parameter_list>;</function_decl>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>prolog0</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>prolog1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_XML_DECL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>prolog1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_XML_DECL</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_PI</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>prolog1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_PI</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_COMMENT</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>prolog1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_COMMENT</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_BOM</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_OPEN</name></expr>:
    <if>if <condition>(<expr>!<call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                             <argument><expr><name>ptr</name> + 2 * <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                             <argument><expr><name>end</name></expr></argument>,
                             <argument><expr><name>KW_DOCTYPE</name></expr></argument>)</argument_list></call></expr>)</condition><then>
      <break>break;</break></then></if>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>doctype0</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_INSTANCE_START</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>error</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_INSTANCE_START</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>prolog1</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_PI</name></expr>:
    <return>return <expr><name>XML_ROLE_PI</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_COMMENT</name></expr>:
    <return>return <expr><name>XML_ROLE_COMMENT</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_BOM</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_OPEN</name></expr>:
    <if>if <condition>(<expr>!<call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                             <argument><expr><name>ptr</name> + 2 * <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                             <argument><expr><name>end</name></expr></argument>,
                             <argument><expr><name>KW_DOCTYPE</name></expr></argument>)</argument_list></call></expr>)</condition><then>
      <break>break;</break></then></if>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>doctype0</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_INSTANCE_START</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>error</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_INSTANCE_START</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>prolog2</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_PI</name></expr>:
    <return>return <expr><name>XML_ROLE_PI</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_COMMENT</name></expr>:
    <return>return <expr><name>XML_ROLE_COMMENT</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_INSTANCE_START</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>error</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_INSTANCE_START</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>doctype0</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
  </case><case>case <expr><name>XML_TOK_PREFIXED_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>doctype1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_NAME</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>doctype1</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OPEN_BRACKET</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>internalSubset</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_INTERNAL_SUBSET</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_CLOSE</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>prolog2</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_CLOSE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_SYSTEM</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>doctype3</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_PUBLIC</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>doctype2</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>doctype2</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>doctype3</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_PUBLIC_ID</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>doctype3</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>doctype4</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_SYSTEM_ID</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>doctype4</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OPEN_BRACKET</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>internalSubset</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_INTERNAL_SUBSET</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_CLOSE</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>prolog2</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_CLOSE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>doctype5</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_CLOSE</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>prolog2</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_CLOSE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>internalSubset</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
               <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
               <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
               <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
               <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_OPEN</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                            <argument><expr><name>ptr</name> + 2 * <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                            <argument><expr><name>end</name></expr></argument>,
                            <argument><expr><name>KW_ENTITY</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity0</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                            <argument><expr><name>ptr</name> + 2 * <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                            <argument><expr><name>end</name></expr></argument>,
                            <argument><expr><name>KW_ATTLIST</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist0</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                            <argument><expr><name>ptr</name> + 2 * <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                            <argument><expr><name>end</name></expr></argument>,
                            <argument><expr><name>KW_ELEMENT</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element0</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                            <argument><expr><name>ptr</name> + 2 * <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                            <argument><expr><name>end</name></expr></argument>,
                            <argument><expr><name>KW_NOTATION</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>notation0</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_NOTATION_NONE</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case><case>case <expr><name>XML_TOK_PI</name></expr>:
    <return>return <expr><name>XML_ROLE_PI</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_COMMENT</name></expr>:
    <return>return <expr><name>XML_ROLE_COMMENT</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_PARAM_ENTITY_REF</name></expr>:
    <return>return <expr><name>XML_ROLE_PARAM_ENTITY_REF</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_BRACKET</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>doctype5</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DOCTYPE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NONE</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<cpp:ifdef>#<cpp:directive>ifdef</cpp:directive> <name>XML_DTD</name></cpp:ifdef>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>externalSubset0</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
                <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
                <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
                <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
                <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>externalSubset1</name></expr>;</expr_stmt>
  <if>if <condition>(<expr><name>tok</name> == <name>XML_TOK_XML_DECL</name></expr>)</condition><then>
    <return>return <expr><name>XML_ROLE_TEXT_DECL</name></expr>;</return></then></if>
  <return>return <expr><call><name>externalSubset1</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>externalSubset1</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
                <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
                <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
                <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
                <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_COND_SECT_OPEN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>condSect0</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_COND_SECT_CLOSE</name></expr>:
    <if>if <condition>(<expr><name><name>state</name>-&gt;<name>includeLevel</name></name> == 0</expr>)</condition><then>
      <break>break;</break></then></if>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>includeLevel</name></name> -= 1</expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_BRACKET</name></expr>:
    <break>break;</break>
  </case><case>case <expr><name>XML_TOK_NONE</name></expr>:
    <if>if <condition>(<expr><name><name>state</name>-&gt;<name>includeLevel</name></name></expr>)</condition><then>
      <break>break;</break></then></if>
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><default>default:
    <return>return <expr><call><name>internalSubset</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr>;</return>
  </default>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif> <comment type="block">/* XML_DTD */</comment>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity0</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_PERCENT</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity2</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_GENERAL_ENTITY_NAME</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity1</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_PARAM_ENTITY_NAME</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity2</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_SYSTEM</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity4</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_PUBLIC</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity3</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ENTITY_NONE</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_VALUE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity3</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity4</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_PUBLIC_ID</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity4</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity5</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_SYSTEM_ID</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity5</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_CLOSE</name></expr>:
    <expr_stmt><expr><call><name>setTopLevel</name><argument_list>(<argument><expr><name>state</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_COMPLETE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_NDATA</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity6</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity6</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ENTITY_NONE</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_NOTATION_NAME</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity7</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_SYSTEM</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity9</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_PUBLIC</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity8</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ENTITY_NONE</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_VALUE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity8</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity9</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_PUBLIC_ID</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity9</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
        <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
        <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>entity10</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_SYSTEM_ID</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>entity10</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ENTITY_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_CLOSE</name></expr>:
    <expr_stmt><expr><call><name>setTopLevel</name><argument_list>(<argument><expr><name>state</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ENTITY_COMPLETE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>notation0</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
          <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NOTATION_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>notation1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_NOTATION_NAME</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>notation1</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
          <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NOTATION_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_SYSTEM</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>notation3</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_NOTATION_NONE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_PUBLIC</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>notation2</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_NOTATION_NONE</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>notation2</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
          <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NOTATION_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>notation4</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_NOTATION_PUBLIC_ID</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>notation3</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
          <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NOTATION_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_NOTATION_NONE</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_NOTATION_SYSTEM_ID</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>notation4</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
          <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NOTATION_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_NOTATION_NONE</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_NOTATION_SYSTEM_ID</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_CLOSE</name></expr>:
    <expr_stmt><expr><call><name>setTopLevel</name><argument_list>(<argument><expr><name>state</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_NOTATION_NO_SYSTEM_ID</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist0</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
  </case><case>case <expr><name>XML_TOK_PREFIXED_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTLIST_ELEMENT_NAME</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist1</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_CLOSE</name></expr>:
    <expr_stmt><expr><call><name>setTopLevel</name><argument_list>(<argument><expr><name>state</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
  </case><case>case <expr><name>XML_TOK_PREFIXED_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist2</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTRIBUTE_NAME</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist2</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <block>{
      <decl_stmt><decl><type><specifier>static</specifier> <specifier>const</specifier> <name>char</name> * <specifier>const</specifier></type> <name><name>types</name><index>[]</index></name> <init>= <expr><block>{
        <expr><name>KW_CDATA</name></expr>,
        <expr><name>KW_ID</name></expr>,
        <expr><name>KW_IDREF</name></expr>,
        <expr><name>KW_IDREFS</name></expr>,
        <expr><name>KW_ENTITY</name></expr>,
        <expr><name>KW_ENTITIES</name></expr>,
        <expr><name>KW_NMTOKEN</name></expr>,
        <expr><name>KW_NMTOKENS</name></expr>,
      }</block></expr></init></decl>;</decl_stmt>
      <decl_stmt><decl><type><name>int</name></type> <name>i</name></decl>;</decl_stmt>
      <for>for (<init><expr><name>i</name> = 0</expr>;</init> <condition><expr><name>i</name> &lt; <call>(<name>int</name>)<argument_list>(<argument><expr><sizeof>sizeof<argument_list>(<argument><expr><name>types</name></expr></argument>)</argument_list></sizeof>/<sizeof>sizeof<argument_list>(<argument><expr><name><name>types</name><index>[<expr>0</expr>]</index></name></expr></argument>)</argument_list></sizeof></expr></argument>)</argument_list></call></expr>;</condition> <incr><expr><name>i</name>++</expr></incr>)
        <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name><name>types</name><index>[<expr><name>i</name></expr>]</index></name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
          <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist8</name></expr>;</expr_stmt>
          <return>return <expr><name>XML_ROLE_ATTRIBUTE_TYPE_CDATA</name> + <name>i</name></expr>;</return>
        }</block></then></if></for>
    }</block>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_NOTATION</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist5</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case><case>case <expr><name>XML_TOK_OPEN_PAREN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist3</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist3</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NMTOKEN</name></expr>:
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
  </case><case>case <expr><name>XML_TOK_PREFIXED_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist4</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTRIBUTE_ENUM_VALUE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist4</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_PAREN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist8</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OR</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist3</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist5</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OPEN_PAREN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist6</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist6</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTRIBUTE_NOTATION_VALUE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist7</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_PAREN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist8</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OR</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist6</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<comment type="block">/* default value */</comment>
<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist8</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_POUND_NAME</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                            <argument><expr><name>ptr</name> + <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                            <argument><expr><name>end</name></expr></argument>,
                            <argument><expr><name>KW_IMPLIED</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist1</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_IMPLIED_ATTRIBUTE_VALUE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                            <argument><expr><name>ptr</name> + <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                            <argument><expr><name>end</name></expr></argument>,
                            <argument><expr><name>KW_REQUIRED</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist1</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_REQUIRED_ATTRIBUTE_VALUE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                            <argument><expr><name>ptr</name> + <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                            <argument><expr><name>end</name></expr></argument>,
                            <argument><expr><name>KW_FIXED</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist9</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_DEFAULT_ATTRIBUTE_VALUE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>attlist9</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ATTLIST_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_LITERAL</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>attlist1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_FIXED_ATTRIBUTE_VALUE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>element0</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
  </case><case>case <expr><name>XML_TOK_PREFIXED_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ELEMENT_NAME</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>element1</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_EMPTY</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ELEMENT_NONE</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_CONTENT_EMPTY</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_ANY</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ELEMENT_NONE</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_CONTENT_ANY</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case><case>case <expr><name>XML_TOK_OPEN_PAREN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element2</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>level</name></name> = 1</expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_GROUP_OPEN</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>element2</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_POUND_NAME</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>,
                            <argument><expr><name>ptr</name> + <call><name>MIN_BYTES_PER_CHAR</name><argument_list>(<argument><expr><name>enc</name></expr></argument>)</argument_list></call></expr></argument>,
                            <argument><expr><name>end</name></expr></argument>,
                            <argument><expr><name>KW_PCDATA</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element3</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_CONTENT_PCDATA</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case><case>case <expr><name>XML_TOK_OPEN_PAREN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>level</name></name> = 2</expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element6</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_GROUP_OPEN</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
  </case><case>case <expr><name>XML_TOK_PREFIXED_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_CONTENT_ELEMENT</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME_QUESTION</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_CONTENT_ELEMENT_OPT</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME_ASTERISK</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_CONTENT_ELEMENT_REP</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME_PLUS</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_CONTENT_ELEMENT_PLUS</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>element3</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_PAREN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ELEMENT_NONE</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_GROUP_CLOSE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_PAREN_ASTERISK</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ELEMENT_NONE</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_GROUP_CLOSE_REP</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OR</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element4</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>element4</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
  </case><case>case <expr><name>XML_TOK_PREFIXED_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element5</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_CONTENT_ELEMENT</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>element5</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_PAREN_ASTERISK</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ELEMENT_NONE</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_GROUP_CLOSE_REP</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OR</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element4</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>element6</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OPEN_PAREN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>level</name></name> += 1</expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_GROUP_OPEN</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
  </case><case>case <expr><name>XML_TOK_PREFIXED_NAME</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_CONTENT_ELEMENT</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME_QUESTION</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_CONTENT_ELEMENT_OPT</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME_ASTERISK</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_CONTENT_ELEMENT_REP</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME_PLUS</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element7</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_CONTENT_ELEMENT_PLUS</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>element7</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
         <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
         <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_ELEMENT_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_PAREN</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>level</name></name> -= 1</expr>;</expr_stmt>
    <if>if <condition>(<expr><name><name>state</name>-&gt;<name>level</name></name> == 0</expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ELEMENT_NONE</name></expr>;</expr_stmt>
    }</block></then></if>
    <return>return <expr><name>XML_ROLE_GROUP_CLOSE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_PAREN_ASTERISK</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>level</name></name> -= 1</expr>;</expr_stmt>
    <if>if <condition>(<expr><name><name>state</name>-&gt;<name>level</name></name> == 0</expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ELEMENT_NONE</name></expr>;</expr_stmt>
    }</block></then></if>
    <return>return <expr><name>XML_ROLE_GROUP_CLOSE_REP</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_PAREN_QUESTION</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>level</name></name> -= 1</expr>;</expr_stmt>
    <if>if <condition>(<expr><name><name>state</name>-&gt;<name>level</name></name> == 0</expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ELEMENT_NONE</name></expr>;</expr_stmt>
    }</block></then></if>
    <return>return <expr><name>XML_ROLE_GROUP_CLOSE_OPT</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_CLOSE_PAREN_PLUS</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>level</name></name> -= 1</expr>;</expr_stmt>
    <if>if <condition>(<expr><name><name>state</name>-&gt;<name>level</name></name> == 0</expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>declClose</name></expr>;</expr_stmt>
      <expr_stmt><expr><name><name>state</name>-&gt;<name>role_none</name></name> = <name>XML_ROLE_ELEMENT_NONE</name></expr>;</expr_stmt>
    }</block></then></if>
    <return>return <expr><name>XML_ROLE_GROUP_CLOSE_PLUS</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_COMMA</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element6</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_GROUP_SEQUENCE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OR</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>element6</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_GROUP_CHOICE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<cpp:ifdef>#<cpp:directive>ifdef</cpp:directive> <name>XML_DTD</name></cpp:ifdef>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>condSect0</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
          <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_NAME</name></expr>:
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_INCLUDE</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>condSect1</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
    }</block></then></if>
    <if>if <condition>(<expr><call><name>XmlNameMatchesAscii</name><argument_list>(<argument><expr><name>enc</name></expr></argument>, <argument><expr><name>ptr</name></expr></argument>, <argument><expr><name>end</name></expr></argument>, <argument><expr><name>KW_IGNORE</name></expr></argument>)</argument_list></call></expr>)</condition><then> <block>{
      <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>condSect2</name></expr>;</expr_stmt>
      <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
    }</block></then></if>
    <break>break;</break>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>condSect1</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
          <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OPEN_BRACKET</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>externalSubset1</name></expr>;</expr_stmt>
    <expr_stmt><expr><name><name>state</name>-&gt;<name>includeLevel</name></name> += 1</expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>condSect2</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
          <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_OPEN_BRACKET</name></expr>:
    <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>externalSubset1</name></expr>;</expr_stmt>
    <return>return <expr><name>XML_ROLE_IGNORE_SECT</name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif> <comment type="block">/* XML_DTD */</comment>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>declClose</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
          <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
          <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <switch>switch <condition>(<expr><name>tok</name></expr>)</condition> <block>{
  <case>case <expr><name>XML_TOK_PROLOG_S</name></expr>:
    <return>return <expr><name><name>state</name>-&gt;<name>role_none</name></name></expr>;</return>
  </case><case>case <expr><name>XML_TOK_DECL_CLOSE</name></expr>:
    <expr_stmt><expr><call><name>setTopLevel</name><argument_list>(<argument><expr><name>state</name></expr></argument>)</argument_list></call></expr>;</expr_stmt>
    <return>return <expr><name><name>state</name>-&gt;<name>role_none</name></name></expr>;</return>
  </case>}</block></switch>
  <return>return <expr><call><name>common</name><argument_list>(<argument><expr><name>state</name></expr></argument>, <argument><expr><name>tok</name></expr></argument>)</argument_list></call></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>PTRCALL</name></type>
<name>error</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>,
      <param><decl><type><name>int</name></type> <name>tok</name></decl></param>,
      <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>ptr</name></decl></param>,
      <param><decl><type><specifier>const</specifier> <name>char</name> *</type><name>end</name></decl></param>,
      <param><decl><type><specifier>const</specifier> <name>ENCODING</name> *</type><name>enc</name></decl></param>)</parameter_list>
<block>{
  <return>return <expr><name>XML_ROLE_NONE</name></expr>;</return>
}</block></function>

<function><type><specifier>static</specifier> <name>int</name> <name>FASTCALL</name></type>
<name>common</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>, <param><decl><type><name>int</name></type> <name>tok</name></decl></param>)</parameter_list>
<block>{
<cpp:ifdef>#<cpp:directive>ifdef</cpp:directive> <name>XML_DTD</name></cpp:ifdef>
  <if>if <condition>(<expr>!<name><name>state</name>-&gt;<name>documentEntity</name></name> &amp;&amp; <name>tok</name> == <name>XML_TOK_PARAM_ENTITY_REF</name></expr>)</condition><then>
    <return>return <expr><name>XML_ROLE_INNER_PARAM_ENTITY_REF</name></expr>;</return></then></if>
<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif>
  <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>error</name></expr>;</expr_stmt>
  <return>return <expr><name>XML_ROLE_ERROR</name></expr>;</return>
}</block></function>

<function><type><name>void</name></type>
<name>XmlPrologStateInit</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>)</parameter_list>
<block>{
  <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>prolog0</name></expr>;</expr_stmt>
<cpp:ifdef>#<cpp:directive>ifdef</cpp:directive> <name>XML_DTD</name></cpp:ifdef>
  <expr_stmt><expr><name><name>state</name>-&gt;<name>documentEntity</name></name> = 1</expr>;</expr_stmt>
  <expr_stmt><expr><name><name>state</name>-&gt;<name>includeLevel</name></name> = 0</expr>;</expr_stmt>
  <expr_stmt><expr><name><name>state</name>-&gt;<name>inEntityValue</name></name> = 0</expr>;</expr_stmt>
<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif> <comment type="block">/* XML_DTD */</comment>
}</block></function>

<cpp:ifdef>#<cpp:directive>ifdef</cpp:directive> <name>XML_DTD</name></cpp:ifdef>

<function><type><name>void</name></type>
<name>XmlPrologStateInitExternalEntity</name><parameter_list>(<param><decl><type><name>PROLOG_STATE</name> *</type><name>state</name></decl></param>)</parameter_list>
<block>{
  <expr_stmt><expr><name><name>state</name>-&gt;<name>handler</name></name> = <name>externalSubset0</name></expr>;</expr_stmt>
  <expr_stmt><expr><name><name>state</name>-&gt;<name>documentEntity</name></name> = 0</expr>;</expr_stmt>
  <expr_stmt><expr><name><name>state</name>-&gt;<name>includeLevel</name></name> = 0</expr>;</expr_stmt>
}</block></function>

<cpp:endif>#<cpp:directive>endif</cpp:directive></cpp:endif> <comment type="block">/* XML_DTD */</comment>
</unit>
